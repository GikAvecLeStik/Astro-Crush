#include <SFML/Graphics.hpp>
#include "Player.hpp"
#include "Menu.hpp"
#include <cmath>
int main()
{
    
   

    sf::RenderWindow window(sf::VideoMode(1280, 720), "SFML works!",sf::Style::Default);
    sf::RectangleShape bg;
    sf::Texture mainbg;
    bg.setSize(sf::Vector2f(1280, 720));
    mainbg.loadFromFile("Textures/menu.png");
    bg.setTexture(&mainbg);
    Player player;
    Menu menu(window.getSize().x, window.getSize().y);
    
    while (window.isOpen())
    {
        
        sf::Event event;
        while (window.pollEvent(event))
        {
            if (event.type == sf::Event::Closed)
            {
                window.close();
            }

            if (event.type == sf::Event::KeyReleased)
            {
                if (event.key.code == sf::Keyboard::W)
                {
                    menu.moveUp();
                    break;
                }

                if (event.key.code == sf::Keyboard::S)
                {
                    menu.moveDown();
                    break;
                }

                if (event.key.code == sf::Keyboard::Return)
                {
                    sf::RenderWindow Jugar(sf::VideoMode(1280, 720), "Astro");
                    Jugar.setView(sf::View(sf::FloatRect(0, 0, 320, 180)));
                    sf::RenderWindow Creditos(sf::VideoMode(1280, 720), "callate");
                    sf::RenderWindow Intrucciones(sf::VideoMode(1280, 720), "bobo");
                    int c = menu.menuPressed();
                    if (c == 0)
                    {
                        while (Jugar.isOpen())
                        {
                            sf::Event aevent;
                            while (Jugar.pollEvent(aevent))
                            {
                                if (aevent.type == sf::Event::Closed)
                                {
                                    Jugar.close();
                                }
                                if (aevent.type == sf::Event::KeyPressed)
                                {
                                    if (aevent.key.code == sf::Keyboard::Escape)
                                    {
                                        Jugar.close();
                                    }
                                }
                            }
                            Intrucciones.close();
                            Creditos.close();
                            
                            player.dt();
                            Jugar.clear();
                            player.draw(Jugar);
                            player.update();
                            Jugar.display();
                        }
                    }
                    if (c == 1)
                    {
                        while (Intrucciones.isOpen())
                        {
                            sf::Event aevent;
                            while (Intrucciones.pollEvent(aevent))
                            {
                                if (aevent.type == sf::Event::Closed)
                                {
                                    Intrucciones.close();
                                }
                                if (aevent.type == sf::Event::KeyPressed)
                                {
                                    if (aevent.key.code == sf::Keyboard::Escape)
                                    {
                                        Intrucciones.close();
                                    }
                                }
                            }
                            Jugar.close();
                            Intrucciones.clear();
                            Creditos.close();
                            Intrucciones.display();
                        }
                    }
                    if (c == 2)
                    {
                        while (Creditos.isOpen())
                        {
                            sf::Event aevent;
                            while (Creditos.pollEvent(aevent))
                            {
                                if (aevent.type == sf::Event::Closed)
                                {
                                    Creditos.close();
                                }
                                if (aevent.type == sf::Event::KeyPressed)
                                {
                                    if (aevent.key.code == sf::Keyboard::Escape)
                                    {
                                        Creditos.close();
                                    }
                                }
                            }
                            
                            Jugar.close();
                            Intrucciones.clear();
                            Creditos.clear();
                            Creditos.display();
                        }
                    }
                    if (c = 3)
                        window.close();
                    break;
                }
            }
        }            
        window.clear();  
        window.draw(bg);
        menu.draw(window);
        window.display();
    }
    return 0;
}
